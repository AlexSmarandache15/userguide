<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="examples-sqf-use_case_1">
  <title>SQF Use Case 1: Impose a DITA Prolog</title>
  <body>
    <p><b>Description:</b> The following sample Schematron rule checks a DITA topic to make sure it
      contains <xmlelement>prolog</xmlelement>, <xmlelement>critdates</xmlelement>,
        <xmlelement>revised</xmlelement> elements and the sample Quick Fix proposes options for
      inserting the missing elements.</p>
    <p><b>Sample
      Code:</b><codeblock outputclass="language-xml">&lt;sch:schema xmlns:sch="http://purl.oclc.org/dsdl/schematron" queryBinding="xslt2"
  xmlns:sqf="http://www.schematron-quickfix.com/validator/process"&gt;
  &lt;sch:pattern&gt;
    &lt;sch:rule context="*[contains(@class, ' topic/topic ')]"&gt;
      &lt;sch:assert sqf:fix="add_prolog" test="prolog" role="warn"&gt;Every topic must contain
            prolog/critdates/revised elements where the revised modified date is in 
            YYYY-MM-DD format.&lt;/sch:assert&gt;
      &lt;sqf:fix id="add_prolog"&gt;
        &lt;sqf:description&gt;
          &lt;sqf:title&gt;Add prolog/critdates/revised elements, where the revised element's
                     @modified attribute value is the current date in YYYY-MM-DD
                     format.&lt;/sqf:title&gt;
          &lt;/sqf:description&gt;
          &lt;sqf:add match="*[contains(@class, ' topic/body ')]" node-type="element"
              position="before" target="prolog"&gt;
              &lt;critdates&gt;
                &lt;revised modified=""&gt; &lt;/revised&gt;
              &lt;/critdates&gt;
          &lt;/sqf:add&gt;
      &lt;/sqf:fix&gt;
    &lt;/sch:rule&gt;

    &lt;sch:rule context="*[contains(@class, ' topic/prolog ')]"&gt;
      &lt;sch:report role="warn" test="not(critdates)" sqf:fix="add_critdates"&gt;The prolog
          element must have critdates/revised elements with the @modified attribute value
          in YYYY-MM-DD format.&lt;/sch:report&gt;
      &lt;sqf:fix id="add_critdates"&gt;
        &lt;sqf:description&gt;
          &lt;sqf:title&gt;Add the critdates element.&lt;/sqf:title&gt;
        &lt;/sqf:description&gt;
        &lt;sqf:add node-type="element" target="critdates"&gt;
          &lt;revised modified=""&gt; &lt;/revised&gt;
        &lt;/sqf:add&gt;
      &lt;/sqf:fix&gt;
    &lt;/sch:rule&gt;

    &lt;sch:rule context="*[contains(@class, ' topic/critdates ')]"&gt;
      &lt;sch:report role="warn" test="not(revised)" sqf:fix="add_revised"&gt;The critdates
             element must have revised @modified in YYYY-MM-DD format. &lt;/sch:report&gt;
      &lt;sqf:fix id="add_revised"&gt;
        &lt;sqf:description&gt;
          &lt;sqf:title&gt;Add the revised element.&lt;/sqf:title&gt;
        &lt;/sqf:description&gt;
        &lt;sqf:add node-type="element" target="revised"/&gt;
      &lt;/sqf:fix&gt;
    &lt;/sch:rule&gt;
  &lt;/sch:pattern&gt;
&lt;/sch:schema&gt;</codeblock></p>
    <p><b>Result:</b> The engine displays an error message if the <xmlelement>prolog</xmlelement>,
        <xmlelement>critdates</xmlelement>, or <xmlelement>revised</xmlelement> elements are missing
      from a DITA topic and the Quick Fix mechanism proposes options for inserting the missing
      elements.</p>
  </body>
</topic>